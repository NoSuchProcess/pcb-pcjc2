Bottom: d584b4b1c2416f18c5564bd31225cba9138d84a9
Top:    d584b4b1c2416f18c5564bd31225cba9138d84a9
Author: Peter Clifton <pcjc2@cam.ac.uk>
Date:   2011-09-14 23:27:45 +0100

undo.c: Add error message where {Save,Restore}UndoSerialNumber() fails

If any operations are added logged for Undo between a call to
IncrementUndoSerialNumber() and call for RestoreUndoSerialNumber(),
those operations will now be in the undo stack with an inconsistent
serial number.

The {Save,Restore}UndoSerialNumber() API is pretty fragile in this
regard, and we should avoid using it where possible. An alternative
might be to implement a "LockUndoSerialNumber()" call which temporarily
disables IncrementUndoSerialNumber(), and a UnlockUndoSerialNumber()
call which restores its function.


---


