Bottom: aed812450035340b1f3477081869b69aabe5f44e
Top:    aed812450035340b1f3477081869b69aabe5f44e
Author: Peter Clifton <pcjc2@cam.ac.uk>
Date:   2011-09-23 01:09:59 +0100

drc: Fix line <-> polygon and polygon <-> polygon tests tests

In src/find.c, the one polygon is tested against a series of bloated
lines following the outline of the second polygon.

In IsPolygonInPolygon() we have:

  line.Thickness = 2 * Bloat;

But the test which is called, IsLineInPolygon()

Also adds bloat to the line:

  lp = LinePoly (Line, Line->Thickness + Bloat)

This bloat is actually half the size we should be adding for this
test, as the LinePoly argument is a line thickness, not cap radius.

Fix this all by doubling the bloat added in IsLineInPolygon(), and
set line.Thickness = 0; in IsPolygonInPolygon().


FIXME: This breaks other DRC checks, particularly those which compute
shrink / insufficient overlap - quite not sure why, but they seem to
rely on the half-bloat being added in various places.


---


